<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Nuxt3+Supabase全栈应用私有化部署全记录 | Tianxingleo的Blog</title><meta name="keywords" content="vps,nuxt,supabase"><meta name="author" content="Tianxingleo"><meta name="copyright" content="Tianxingleo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Nuxt3+Supabase全栈应用私有化部署全记录"><meta name="application-name" content="Nuxt3+Supabase全栈应用私有化部署全记录"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Nuxt3+Supabase全栈应用私有化部署全记录"><meta property="og:url" content="http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/index.html"><meta property="og:site_name" content="Tianxingleo的Blog"><meta property="og:description" content="Nuxt3 + Supabase 全栈应用私有化部署全记录  本文由 opencode + glm4.7 整理   文章结构 本文分为两个主要部分： 第一部分：理想之路 —— 标准化部署 SOP 详细介绍在理想情况下应该如何进行部署，包括环境准备、Supabase 配置、数据迁移、Nuxt 部署等"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.jpg?_r_=1181c49c-f5a9-72b5-5e04-c0abe2b5f579"><meta property="article:author" content="Tianxingleo"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.jpg?_r_=1181c49c-f5a9-72b5-5e04-c0abe2b5f579"><meta name="description" content="Nuxt3 + Supabase 全栈应用私有化部署全记录  本文由 opencode + glm4.7 整理   文章结构 本文分为两个主要部分： 第一部分：理想之路 —— 标准化部署 SOP 详细介绍在理想情况下应该如何进行部署，包括环境准备、Supabase 配置、数据迁移、Nuxt 部署等"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2abdc2befae45d70b9fd72c864f6fac0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-NVDE0BFR5M"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-NVDE0BFR5M');
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"tianli","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"S-IQC7J39MX5C7PRZM","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: {"appId":"66YB7CN8AP","apiKey":"61956196bfa43507ef197aade2f06e78","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Tianxingleo","link":"链接: ","source":"来源: Tianxingleo的Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Tianxingleo的Blog',
  title: 'Nuxt3+Supabase全栈应用私有化部署全记录',
  postAI: '',
  pageFillDescription: ' Nuxt3 + Supabase 全栈应用私有化部署全记录,  文章结构,  第一部分：理想之路 —— 标准化部署 SOP (如果不踩坑你应该这样做),  一、 基础设施与环境准备 (Infrastructure),  1.1 服务器选型与初始化,  硬件基准配置,  安全组配置 (Firewall),  磁盘空间管理,  Swap 虚拟内存配置,  1.2 核心软件安装,  Git 安装与 SSH Key 配置,  Docker amp Docker Compose v2 安装,  二、 Supabase 后端私有化部署 (Backend),  2.1 官方 Docker 仓库配置,  获取 Supabase Docker 配置,  2.2 环境变量 (.env) 黄金法则,  安全核心：JWT_SECRET 配置,  密码陷阱：特殊符号限制,  2.3 服务启动与验证,  启动 Supabase 服务,  三、 数据迁移策略 (Migration Strategy),  3.1 数据库结构迁移 (Schema),  导出 Schema-only 结构,  四、 Nuxt 3 前端容器化适配 (Frontend Adaptation),  4.1 配置文件深度调优 (nuxt.config.ts),  内存优化配置,  4.2 Dockerfile 编写规范,  完整的 Dockerfile 示例,  五、 自动化部署 (CI/CD with GitHub Actions),  5.1 密钥管理,  GitHub Secrets 配置,  六、 网关与安全 (Nginx amp SSL),  6.1 Nginx 反向代理配置,  多域名策略配置,  6.2 SSL 证书自动化,  申请 SSL 证书,  第二部分：实战踩坑实录 —— 每一个报错背后的血泪 (The Debugging Logs),  💀 阶段一：环境与基础设施的下马威,  坑点 1：Docker 安装包失踪,  坑点 2：服务器磁盘空间幽灵,  💀 阶段二：Supabase 数据库的密码地狱 (最艰难的战役),  坑点 3：特殊字符引发的连接串解析失败,  坑点 4：Docker 卷持久化导致的密码分裂,  💀 阶段三：Nuxt 构建与运行时的崩溃循环,  坑点 5：构建时内存溢出 (OOM),  坑点 6：SSR 环境下的 Pinia 崩溃,  💀 阶段四：连通性与配置的最后一步,  坑点 7：无效的 API Key (Invalid Signature),  坑点 8：Certbot Python 环境冲突,  结语,  核心经验总结,  最关键的经验教训,  1. 永远掌控你的配置,  2. 资源限制下的优化策略,  给后来者的建议,  部署前准备,  部署过程中,  最终的价值全栈应用私有化部署全记录本文由整理文章结构本文分为两个主要部分第一部分理想之路标准化部署详细介绍在理想情况下应该如何进行部署包括环境准备配置数据迁移部署等完整流程第二部分实战踩坑实录每一个报错背后的血泪真实还原部署过程中遇到的各种问题从安装失败到数据库密码地狱再到构建优化等为读者提供避坑指南第一部分理想之路标准化部署如果不踩坑你应该这样做核心逻辑基于使用编排配合运行并通过实现自动化部署最后由进行反向代理和终结一基础设施与环境准备服务器选型与初始化硬件基准配置在部署全栈应用时服务器配置需要综合考虑以下因素推荐配置核心起步推荐核心并行处理数据库查询和前端构建内存起步推荐构建应用时内存消耗极大存储起步数据库日志文件存储带宽起步推荐考虑用户访问和文件传输为什么内存对构建至关重要的构建过程尤其是服务器构建是内存密集型任务构建时的内存消耗分析编译打包代码分割总计峰值如果在内存服务器上直接构建极易触发错误安全组配置必须开放的端口基础服务端口管理访问访问访问严禁直接暴露的端口数据库和服务端口仅内网访问数据库网关应用服务磁盘空间管理检查磁盘挂载情况输出示例处理云盘扩容后的文件系统调整查看磁盘分区情况扩展分区假设扩容扩展文件系统验证扩容结果虚拟内存配置为何小内存服务器必须配置构建缓冲和时临时缓解内存压力防止避免内核强制杀死进程多任务支持允许同时运行和构建任务创建的标准命令创建文件设置权限格式化为启用永久生效添加到验证状态核心软件安装安装与配置安装配置用户信息生成用于访问查看公钥并添加到安装避坑指南不使用默认源的版本通常较旧且不包含错误方式会导致版本过旧和插件缺失错误推荐方案官方脚本国内镜像源下载官方安装脚本使用阿里云镜像安装国内服务器必需启动服务添加用户到组避免验证安装二后端私有化部署官方仓库配置获取配置进入用户主目录克隆配置使用浅克隆减少下载量进入配置目录环境变量黄金法则安全核心配置生成强随机字符串至少字符输出示例在中设置为什么必须固定用于生成和验证所有访问令牌变更会导致所有现有令牌失效数据库中的用户密码哈希依赖此密码陷阱特殊符号限制错误示例会导致连接串解析失败正确示例使用字母数字组合服务启动与验证启动服务拉取所有镜像首次执行启动所有服务查看启动日志可选三数据迁移策略数据库结构迁移导出结构从获取连接字符串格式导出架构的结构不含数据你的密码你的项目四前端容器化适配配置文件深度调优内存优化配置构建优化关闭减少构建时间服务器配置限制并发防止内存溢出只预渲染首页解决第三方库路径问题内联避免路径丢失错误编写规范完整的示例选择合适的基础镜像安装构建依赖解决原生模块编译问题构建阶段生产运行阶段五自动化部署密钥管理配置在仓库的中配置以下密钥服务器连接信息应用密钥六网关与安全反向代理配置多域名策略配置前端主站网关证书自动化申请证书前端域名域名第二部分实战踩坑实录每一个报错背后的血泪核心逻辑按时间线还原真实遇到的问题从环境配置到数据库崩溃再到前端构建失败和最终的连通性问题每一个错误都代表着一个宝贵的经验教训阶段一环境与基础设施的下马威坑点安装包失踪报错现场最终解决方案使用国内镜像经验教训不要盲目相信系统源对于这类快速发展的工具官方源总是领先于系统源国内服务器必须考虑网络因素直接访问国外资源往往不稳定坑点服务器磁盘空间幽灵报错现场解决过程经验教训云盘扩容需要两步操作分区扩展文件系统扩展看到的不一定是真实大小需要用确认磁盘实际大小阶段二数据库的密码地狱最艰难的战役坑点特殊字符引发的连接串解析失败报错现场最终解决方案移除所有特殊字符坑点卷持久化导致的密码分裂问题分析的卷持久化机制保存了旧的数据库配置即使修改了文件已经存在的数据库数据仍然使用旧密码最终解决方案数据库上帝模式重置修改为模式无密码连接并重置所有系统账号阶段三构建与运行时的崩溃循环坑点构建时内存溢出报错现场服务器卡死连接断开解决过程步骤一配置虚拟内存步骤二优化配置坑点环境下的崩溃报错现场最终解决方案将通用插件改为客户端专用阶段四连通性与配置的最后一步坑点无效的报错现场解决过程固定使用重新生成坑点环境冲突报错现场解决方案结语核心经验总结经过这次完整的私有化部署实践我们深刻体会到全栈独立开发不仅仅是写代码更是对网络协议和构建工具链的综合考验最关键的经验教训永远掌控你的配置不要相信自动生成的配置必须手动生成并固定自动生成会导致所有失效数据库密码避免特殊字符连接串解析很脆弱资源限制下的优化策略小内存服务器必须做针对性优化虚拟内存是必备的构建优化配置给后来者的建议部署前准备充分测试在类似环境先完整测试一遍部署流程备份策略确保有完整的备份和恢复方案监控准备提前配置好日志收集和监控告警部署过程中分步验证每完成一个阶段就验证功能正常日志监控实时监控各服务的日志及时发现问题回滚准备准备好快速回滚方案减少故障时间最终的价值虽然私有化部署过程充满挑战但带来的价值是显著的数据掌控所有数据都在自己的服务器中满足合规要求成本可控避免了服务的指数级费用增长性能优化可以根据业务需求进行针对性优化技术成长全栈部署经验是工程师的重要技能相关资源官方文档部署指南最佳实践配置优化如有问题或建议欢迎提交或本文由基于真实部署对话整理记录了从踩坑到成功的完整私有化部署历程',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-10 17:15:39',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="Tianxingleo的Blog" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://avatars.githubusercontent.com/u/237200863?v=4"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://tianxingleo.github.io" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://avatars.githubusercontent.com/u/237200863?v=4" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/tianxingleo" title="Github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.githubassets.com/assets/GitHub-Mark-ea2971cee799.png" alt="Github"/><span class="back-menu-item-text">Github</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Tianxingleo的Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/3dgs/" style="font-size: 1.05rem;">3dgs<sup>7</sup></a><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/CG/" style="font-size: 1.05rem;">CG<sup>6</sup></a><a href="/tags/CV/" style="font-size: 1.05rem;">CV<sup>5</sup></a><a href="/tags/GAMES/" style="font-size: 1.05rem;">GAMES<sup>1</sup></a><a href="/tags/GAMES101/" style="font-size: 1.05rem;">GAMES101<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 1.05rem;">LLM<sup>1</sup></a><a href="/tags/NAOSI/" style="font-size: 1.05rem;">NAOSI<sup>1</sup></a><a href="/tags/SDFoam/" style="font-size: 1.05rem;">SDFoam<sup>4</sup></a><a href="/tags/c/" style="font-size: 1.05rem;">c<sup>4</sup></a><a href="/tags/cpc/" style="font-size: 1.05rem;">cpc<sup>4</sup></a><a href="/tags/cpp/" style="font-size: 1.05rem;">cpp<sup>14</sup></a><a href="/tags/css/" style="font-size: 1.05rem;">css<sup>1</sup></a><a href="/tags/frp/" style="font-size: 1.05rem;">frp<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem;">html<sup>1</sup></a><a href="/tags/mask/" style="font-size: 1.05rem;">mask<sup>1</sup></a><a href="/tags/nerfstudio/" style="font-size: 1.05rem;">nerfstudio<sup>1</sup></a><a href="/tags/nuxt/" style="font-size: 1.05rem;">nuxt<sup>1</sup></a><a href="/tags/sam/" style="font-size: 1.05rem;">sam<sup>1</sup></a><a href="/tags/sam3/" style="font-size: 1.05rem;">sam3<sup>1</sup></a><a href="/tags/ssh/" style="font-size: 1.05rem;">ssh<sup>1</sup></a><a href="/tags/supabase/" style="font-size: 1.05rem;">supabase<sup>1</sup></a><a href="/tags/tic/" style="font-size: 1.05rem;">tic<sup>1</sup></a><a href="/tags/vps/" style="font-size: 1.05rem;">vps<sup>3</sup></a><a href="/tags/vscode/" style="font-size: 1.05rem;">vscode<sup>2</sup></a><a href="/tags/yolo/" style="font-size: 1.05rem;">yolo<sup>1</sup></a><a href="/tags/%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA/" style="font-size: 1.05rem;">三维重建<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 1.05rem;">函数<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>1</sup></a><a href="/tags/%E5%A4%A7%E5%AD%A6/" style="font-size: 1.05rem;">大学<sup>11</sup></a><a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1.05rem;">字符串<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">学习<sup>6</sup></a><a href="/tags/%E6%8C%87%E9%92%88/" style="font-size: 1.05rem;">指针<sup>2</sup></a><a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 1.05rem;">搜索<sup>1</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">服务器<sup>1</sup></a><a href="/tags/%E7%95%99%E5%AD%A6/" style="font-size: 1.05rem;">留学<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.05rem;">算法<sup>6</sup></a><a href="/tags/%E7%BB%93%E6%9E%84%E4%BD%93/" style="font-size: 1.05rem;">结构体<sup>1</sup></a><a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 1.05rem;">链表<sup>1</sup></a><a href="/tags/%E9%AB%98%E6%95%B0/" style="font-size: 1.05rem;">高数<sup>7</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2026/02/"><span class="card-archive-list-date">二月 2026</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2026/01/"><span class="card-archive-list-date">一月 2026</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/12/"><span class="card-archive-list-date">十二月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/11/"><span class="card-archive-list-date">十一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/10/"><span class="card-archive-list-date">十月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">11</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/vps/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>vps</span></a><a class="article-meta__tags" href="/tags/nuxt/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>nuxt</span></a><a class="article-meta__tags" href="/tags/supabase/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>supabase</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Nuxt3+Supabase全栈应用私有化部署全记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2026-02-10T08:01:34.000Z" title="发表于 2026-02-10 16:01:34">2026-02-10</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2026-02-10T09:15:39.006Z" title="更新于 2026-02-10 17:15:39">2026-02-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Nuxt3+Supabase全栈应用私有化部署全记录"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广州</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.jpg?_r_=1181c49c-f5a9-72b5-5e04-c0abe2b5f579"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/"><header><a href="/tags/vps/" tabindex="-1" itemprop="url">vps</a><a href="/tags/nuxt/" tabindex="-1" itemprop="url">nuxt</a><a href="/tags/supabase/" tabindex="-1" itemprop="url">supabase</a><h1 id="CrawlerTitle" itemprop="name headline">Nuxt3+Supabase全栈应用私有化部署全记录</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Tianxingleo</span><time itemprop="dateCreated datePublished" datetime="2026-02-10T08:01:34.000Z" title="发表于 2026-02-10 16:01:34">2026-02-10</time><time itemprop="dateCreated datePublished" datetime="2026-02-10T09:15:39.006Z" title="更新于 2026-02-10 17:15:39">2026-02-10</time></header><h1 id="nuxt3-supabase-全栈应用私有化部署全记录"><a class="markdownIt-Anchor" href="#nuxt3-supabase-全栈应用私有化部署全记录"></a> Nuxt3 + Supabase 全栈应用私有化部署全记录</h1>
<blockquote>
<p>本文由 opencode + glm4.7 整理</p>
</blockquote>
<h3 id="文章结构"><a class="markdownIt-Anchor" href="#文章结构"></a> 文章结构</h3>
<p>本文分为两个主要部分：</p>
<p><strong>第一部分：理想之路 —— 标准化部署 SOP</strong><br />
详细介绍在理想情况下应该如何进行部署，包括环境准备、Supabase 配置、数据迁移、Nuxt 部署等完整流程。</p>
<p><strong>第二部分：实战踩坑实录 —— 每一个报错背后的血泪</strong><br />
真实还原部署过程中遇到的各种问题，从 Docker 安装失败到数据库密码地狱，再到构建优化等，为读者提供避坑指南。</p>
<hr />
<h2 id="第一部分理想之路-标准化部署-sop-如果不踩坑你应该这样做"><a class="markdownIt-Anchor" href="#第一部分理想之路-标准化部署-sop-如果不踩坑你应该这样做"></a> 第一部分：理想之路 —— 标准化部署 SOP (如果不踩坑，你应该这样做)</h2>
<blockquote>
<p>💡 <strong>核心逻辑</strong>：基于 Ubuntu 22.04 LTS，使用 Docker Compose 编排 Supabase，配合 Docker 运行 Nuxt3，并通过 GitHub Actions 实现自动化部署，最后由 Nginx 进行反向代理和 SSL 终结。</p>
</blockquote>
<h3 id="一-基础设施与环境准备-infrastructure"><a class="markdownIt-Anchor" href="#一-基础设施与环境准备-infrastructure"></a> 一、 基础设施与环境准备 (Infrastructure)</h3>
<h4 id="11-服务器选型与初始化"><a class="markdownIt-Anchor" href="#11-服务器选型与初始化"></a> 1.1 服务器选型与初始化</h4>
<h5 id="硬件基准配置"><a class="markdownIt-Anchor" href="#硬件基准配置"></a> 硬件基准配置</h5>
<p>在部署 Supabase + Nuxt 3 全栈应用时，服务器配置需要综合考虑以下因素：</p>
<p><strong>推荐配置</strong>：</p>
<ul>
<li><strong>CPU</strong>: 2核心起步，推荐 4 核心（并行处理数据库查询和前端构建）</li>
<li><strong>内存</strong>: 4GB 起步，推荐 8GB（构建 Nuxt 应用时内存消耗极大）</li>
<li><strong>存储</strong>: 50GB SSD 起步（数据库 + 日志 + 文件存储）</li>
<li><strong>带宽</strong>: 5Mbps 起步，推荐 10Mbps（考虑用户访问和文件传输）</li>
</ul>
<p><strong>为什么内存对构建至关重要</strong>：</p>
<p>Nuxt 3 的构建过程（尤其是 Nitro 服务器构建）是内存密集型任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建时的内存消耗分析</span></span><br><span class="line">Building Nuxt Nitro server...</span><br><span class="line"><span class="comment"># - TypeScript 编译：~1GB</span></span><br><span class="line"><span class="comment"># - Bundle 打包：~1.5GB  </span></span><br><span class="line"><span class="comment"># - 代码分割：~512MB</span></span><br><span class="line"><span class="comment"># - 总计：~3GB+ 峰值</span></span><br></pre></td></tr></table></figure>
<p>如果在 2GB 内存服务器上直接构建，极易触发 OOM (Out of Memory) 错误。</p>
<h5 id="安全组配置-firewall"><a class="markdownIt-Anchor" href="#安全组配置-firewall"></a> 安全组配置 (Firewall)</h5>
<p><strong>必须开放的端口</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础服务端口</span></span><br><span class="line">22  <span class="comment"># SSH 管理访问</span></span><br><span class="line">80  <span class="comment"># HTTP 访问</span></span><br><span class="line">443 <span class="comment"># HTTPS 访问</span></span><br></pre></td></tr></table></figure>
<p><strong>严禁直接暴露的端口</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据库和服务端口（仅内网访问）</span></span><br><span class="line">5432 <span class="comment"># PostgreSQL 数据库</span></span><br><span class="line">8000 <span class="comment"># Kong API 网关</span></span><br><span class="line">8001 <span class="comment"># Supabase Studio</span></span><br><span class="line">3000 <span class="comment"># Nuxt 应用服务</span></span><br></pre></td></tr></table></figure>
<h5 id="磁盘空间管理"><a class="markdownIt-Anchor" href="#磁盘空间管理"></a> 磁盘空间管理</h5>
<p><strong>检查磁盘挂载情况</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br><span class="line"><span class="comment"># 输出示例：</span></span><br><span class="line"><span class="comment"># Filesystem      Size  Used Avail Use% Mounted on</span></span><br><span class="line"><span class="comment"># /dev/vda1        40G   12G   26G  32% /</span></span><br><span class="line"><span class="comment"># /dev/vdb         100G   1G   99G   1% /data</span></span><br></pre></td></tr></table></figure>
<p><strong>处理云盘扩容后的文件系统调整</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 查看磁盘分区情况</span></span><br><span class="line">fdisk -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 扩展分区（假设扩容 /dev/vda1）</span></span><br><span class="line">growpart /dev/vda 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 扩展文件系统</span></span><br><span class="line">resize2fs /dev/vda1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 验证扩容结果</span></span><br><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure>
<h5 id="swap-虚拟内存配置"><a class="markdownIt-Anchor" href="#swap-虚拟内存配置"></a> Swap 虚拟内存配置</h5>
<p><strong>为何小内存服务器必须配置 Swap</strong>：</p>
<ul>
<li><strong>构建缓冲</strong>: npm install 和 npm run build 时临时缓解内存压力</li>
<li><strong>防止 OOM</strong>: 避免 Linux 内核强制杀死进程</li>
<li><strong>多任务支持</strong>: 允许同时运行 Supabase 和 Nuxt 构建任务</li>
</ul>
<p><strong>创建 4GB Swap 的标准命令</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建 Swap 文件</span></span><br><span class="line">fallocate -l 4G /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 设置权限</span></span><br><span class="line"><span class="built_in">chmod</span> 600 /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 格式化为 Swap</span></span><br><span class="line">mkswap /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 启用 Swap</span></span><br><span class="line">swapon /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 永久生效（添加到 /etc/fstab）</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/swapfile none swap sw 0 0&#x27;</span> &gt;&gt; /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 验证 Swap 状态</span></span><br><span class="line">swapon --show</span><br><span class="line">free -h</span><br></pre></td></tr></table></figure>
<h4 id="12-核心软件安装"><a class="markdownIt-Anchor" href="#12-核心软件安装"></a> 1.2 核心软件安装</h4>
<h5 id="git-安装与-ssh-key-配置"><a class="markdownIt-Anchor" href="#git-安装与-ssh-key-配置"></a> Git 安装与 SSH Key 配置</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 安装 Git</span></span><br><span class="line"><span class="built_in">sudo</span> apt update &amp;&amp; <span class="built_in">sudo</span> apt install git -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置 Git 用户信息</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;your.email@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 生成 SSH Key（用于 GitHub 访问）</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;your.email@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 查看公钥并添加到 GitHub</span></span><br><span class="line"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<h5 id="docker-docker-compose-v2-安装"><a class="markdownIt-Anchor" href="#docker-docker-compose-v2-安装"></a> Docker &amp; Docker Compose v2 安装</h5>
<p><strong>避坑指南：不使用 apt install <a target="_blank" rel="noopener" href="http://docker.io">docker.io</a></strong></p>
<p>Ubuntu 默认源的 Docker 版本通常较旧且不包含 <code>docker-compose-plugin</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ❌ 错误方式（会导致版本过旧和插件缺失）</span></span><br><span class="line"><span class="built_in">sudo</span> apt install docker.io docker-compose-plugin -y</span><br><span class="line"><span class="comment"># 错误：E: Unable to locate package docker-compose-plugin</span></span><br></pre></td></tr></table></figure>
<p><strong>推荐方案：官方脚本 + 国内镜像源</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 下载官方安装脚本</span></span><br><span class="line">curl -fsSL https://get.docker.com -o get-docker.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 使用阿里云镜像安装（国内服务器必需）</span></span><br><span class="line"><span class="built_in">sudo</span> sh get-docker.sh --mirror Aliyun</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启动 Docker 服务</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl start docker</span><br><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 添加用户到 docker 组（避免 sudo）</span></span><br><span class="line"><span class="built_in">sudo</span> usermod -aG docker <span class="variable">$USER</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 验证安装</span></span><br><span class="line">docker --version</span><br><span class="line"><span class="comment"># Docker version 24.0.x, build xxx</span></span><br><span class="line"></span><br><span class="line">docker compose version  </span><br><span class="line"><span class="comment"># Docker Compose version v2.20.x</span></span><br></pre></td></tr></table></figure>
<h3 id="二-supabase-后端私有化部署-backend"><a class="markdownIt-Anchor" href="#二-supabase-后端私有化部署-backend"></a> 二、 Supabase 后端私有化部署 (Backend)</h3>
<h4 id="21-官方-docker-仓库配置"><a class="markdownIt-Anchor" href="#21-官方-docker-仓库配置"></a> 2.1 官方 Docker 仓库配置</h4>
<h5 id="获取-supabase-docker-配置"><a class="markdownIt-Anchor" href="#获取-supabase-docker-配置"></a> 获取 Supabase Docker 配置</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 进入用户主目录</span></span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 克隆 Supabase Docker 配置（使用浅克隆减少下载量）</span></span><br><span class="line">git <span class="built_in">clone</span> --depth 1 https://mirror.ghproxy.com/https://github.com/supabase/supabase</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 进入 Docker 配置目录</span></span><br><span class="line"><span class="built_in">cd</span> supabase/docker</span><br></pre></td></tr></table></figure>
<h4 id="22-环境变量-env-黄金法则"><a class="markdownIt-Anchor" href="#22-环境变量-env-黄金法则"></a> 2.2 环境变量 (<code>.env</code>) 黄金法则</h4>
<h5 id="安全核心jwt_secret-配置"><a class="markdownIt-Anchor" href="#安全核心jwt_secret-配置"></a> 安全核心：JWT_SECRET 配置</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成强随机字符串（至少 32 字符）</span></span><br><span class="line">openssl rand -<span class="built_in">base64</span> 32</span><br><span class="line"><span class="comment"># 输出示例：Jk8s9D2f7G4hP1qR6tW3zY5uV8iA0mN1xL4cB5eF7gH2jK9lP3oQ6rS8tU1vW</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 .env 中设置</span></span><br><span class="line">JWT_SECRET=Jk8s9D2f7G4hP1qR6tW3zY5uV8iA0mN1xL4cB5eF7gH2jK9lP3oQ6rS8tU1vW</span><br></pre></td></tr></table></figure>
<p><strong>为什么 JWT_SECRET 必须固定</strong>：</p>
<ul>
<li>JWT Secret 用于生成和验证所有 API 访问令牌</li>
<li>Secret 变更会导致所有现有令牌失效</li>
<li>数据库中的用户密码哈希依赖此 Secret</li>
</ul>
<h5 id="密码陷阱特殊符号限制"><a class="markdownIt-Anchor" href="#密码陷阱特殊符号限制"></a> 密码陷阱：特殊符号限制</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ❌ 错误示例（会导致连接串解析失败）</span></span><br><span class="line">POSTGRES_PASSWORD=P@ssw0rd@2022</span><br><span class="line">POSTGRES_PASSWORD=admin:password</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 正确示例（使用字母数字组合）</span></span><br><span class="line">POSTGRES_PASSWORD=SuperCore2022Admin</span><br><span class="line">POSTGRES_PASSWORD=adminpassword2022</span><br></pre></td></tr></table></figure>
<h4 id="23-服务启动与验证"><a class="markdownIt-Anchor" href="#23-服务启动与验证"></a> 2.3 服务启动与验证</h4>
<h5 id="启动-supabase-服务"><a class="markdownIt-Anchor" href="#启动-supabase-服务"></a> 启动 Supabase 服务</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 拉取所有镜像（首次执行）</span></span><br><span class="line">docker compose pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 启动所有服务</span></span><br><span class="line">docker compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 查看启动日志（可选）</span></span><br><span class="line">docker compose logs -f</span><br></pre></td></tr></table></figure>
<h3 id="三-数据迁移策略-migration-strategy"><a class="markdownIt-Anchor" href="#三-数据迁移策略-migration-strategy"></a> 三、 数据迁移策略 (Migration Strategy)</h3>
<h4 id="31-数据库结构迁移-schema"><a class="markdownIt-Anchor" href="#31-数据库结构迁移-schema"></a> 3.1 数据库结构迁移 (Schema)</h4>
<h5 id="导出-schema-only-结构"><a class="markdownIt-Anchor" href="#导出-schema-only-结构"></a> 导出 Schema-only 结构</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 从 Supabase Dashboard 获取连接字符串</span></span><br><span class="line"><span class="comment"># 格式：postgresql://postgres:[PASSWORD]@db.[PROJECT_REF].supabase.co:5432/postgres</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 导出 public 架构的结构（不含数据）</span></span><br><span class="line">pg_dump <span class="string">&quot;postgresql://postgres:你的密码@db.你的项目ID.supabase.co:5432/postgres&quot;</span> \</span><br><span class="line">  --schema-only \</span><br><span class="line">  --schema=public \</span><br><span class="line">  --quote-all-identifiers \</span><br><span class="line">  --no-owner \</span><br><span class="line">  --no-privileges \</span><br><span class="line">  &gt; schema_structure.sql</span><br></pre></td></tr></table></figure>
<h3 id="四-nuxt-3-前端容器化适配-frontend-adaptation"><a class="markdownIt-Anchor" href="#四-nuxt-3-前端容器化适配-frontend-adaptation"></a> 四、 Nuxt 3 前端容器化适配 (Frontend Adaptation)</h3>
<h4 id="41-配置文件深度调优-nuxtconfigts"><a class="markdownIt-Anchor" href="#41-配置文件深度调优-nuxtconfigts"></a> 4.1 配置文件深度调优 (<code>nuxt.config.ts</code>)</h4>
<h5 id="内存优化配置"><a class="markdownIt-Anchor" href="#内存优化配置"></a> 内存优化配置</h5>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nuxt.config.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineNuxtConfig</span>(&#123;</span><br><span class="line">  <span class="comment">// 🔧 构建优化</span></span><br><span class="line">  <span class="attr">sourcemap</span>: <span class="literal">false</span>,           <span class="comment">// 关闭 SourceMap，减少 40% 构建时间</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 🔧 Nitro 服务器配置</span></span><br><span class="line">  <span class="attr">nitro</span>: &#123;</span><br><span class="line">    <span class="attr">prerender</span>: &#123;</span><br><span class="line">      <span class="attr">concurrency</span>: <span class="number">1</span>,         <span class="comment">// 限制并发，防止内存溢出</span></span><br><span class="line">      <span class="attr">routes</span>: [<span class="string">&#x27;/&#x27;</span>]           <span class="comment">// 只预渲染首页</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 🔧 解决第三方库路径问题</span></span><br><span class="line">    <span class="attr">externals</span>: &#123;</span><br><span class="line">      <span class="attr">inline</span>: [<span class="string">&#x27;tslib&#x27;</span>]       <span class="comment">// 内联 tslib，避免路径丢失错误</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="42-dockerfile-编写规范"><a class="markdownIt-Anchor" href="#42-dockerfile-编写规范"></a> 4.2 Dockerfile 编写规范</h4>
<h5 id="完整的-dockerfile-示例"><a class="markdownIt-Anchor" href="#完整的-dockerfile-示例"></a> 完整的 Dockerfile 示例</h5>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dockerfile</span></span><br><span class="line"><span class="comment"># 🔧 选择合适的基础镜像</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">20</span>-alpine AS base</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 🔧 安装构建依赖（解决原生模块编译问题）</span></span><br><span class="line"><span class="keyword">FROM</span> base AS deps</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk add --no-cache python3 make g++</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json package-lock.json ./</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm ci --only=production &amp;&amp; npm cache clean --force</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 🔧 构建阶段</span></span><br><span class="line"><span class="keyword">FROM</span> base AS builder</span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=deps /app/node_modules ./node_modules</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm run build</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 🔧 生产运行阶段</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">20</span>-alpine AS runner</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/.output ./.output</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/node_modules ./node_modules</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> HOST=<span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"><span class="keyword">ENV</span> PORT=<span class="number">3000</span></span><br><span class="line"><span class="keyword">ENV</span> NODE_ENV=production</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;node&quot;</span>, <span class="string">&quot;.output/server/index.mjs&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<h3 id="五-自动化部署-cicd-with-github-actions"><a class="markdownIt-Anchor" href="#五-自动化部署-cicd-with-github-actions"></a> 五、 自动化部署 (CI/CD with GitHub Actions)</h3>
<h4 id="51-密钥管理"><a class="markdownIt-Anchor" href="#51-密钥管理"></a> 5.1 密钥管理</h4>
<h5 id="github-secrets-配置"><a class="markdownIt-Anchor" href="#github-secrets-配置"></a> GitHub Secrets 配置</h5>
<p>在 GitHub 仓库的 <code>Settings &gt; Secrets and variables &gt; Actions</code> 中配置以下密钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 🔧 服务器连接信息</span></span><br><span class="line">SERVER_HOST=your-server-ip</span><br><span class="line">SSH_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 🔧 应用密钥</span></span><br><span class="line">SUPABASE_URL=http://127.0.0.1:8000</span><br><span class="line">SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</span><br><span class="line">SUPABASE_SECRET_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</span><br></pre></td></tr></table></figure>
<h3 id="六-网关与安全-nginx-ssl"><a class="markdownIt-Anchor" href="#六-网关与安全-nginx-ssl"></a> 六、 网关与安全 (Nginx &amp; SSL)</h3>
<h4 id="61-nginx-反向代理配置"><a class="markdownIt-Anchor" href="#61-nginx-反向代理配置"></a> 6.1 Nginx 反向代理配置</h4>
<h5 id="多域名策略配置"><a class="markdownIt-Anchor" href="#多域名策略配置"></a> 多域名策略配置</h5>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 🌐 前端主站 - www.supercore.hk</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">server_name</span> www.supercore.hk supercore.hk;</span><br><span class="line">    </span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:3000;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 🔧 API 网关 - api.supercore.hk</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">server_name</span> api.supercore.hk;</span><br><span class="line">    </span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:8000;</span><br><span class="line">        <span class="attribute">client_max_body_size</span> <span class="number">50M</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="62-ssl-证书自动化"><a class="markdownIt-Anchor" href="#62-ssl-证书自动化"></a> 6.2 SSL 证书自动化</h4>
<h5 id="申请-ssl-证书"><a class="markdownIt-Anchor" href="#申请-ssl-证书"></a> 申请 SSL 证书</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 🚀 前端域名</span></span><br><span class="line"><span class="built_in">sudo</span> certbot --nginx -d www.supercore.hk -d supercore.hk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 🚀 API 域名</span></span><br><span class="line"><span class="built_in">sudo</span> certbot --nginx -d api.supercore.hk</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="第二部分实战踩坑实录-每一个报错背后的血泪-the-debugging-logs"><a class="markdownIt-Anchor" href="#第二部分实战踩坑实录-每一个报错背后的血泪-the-debugging-logs"></a> 第二部分：实战踩坑实录 —— 每一个报错背后的血泪 (The Debugging Logs)</h2>
<blockquote>
<p>💡 <strong>核心逻辑</strong>：按时间线还原真实遇到的问题，从环境配置到数据库崩溃，再到前端构建失败和最终的连通性问题。每一个错误都代表着一个宝贵的经验教训。</p>
</blockquote>
<h3 id="阶段一环境与基础设施的下马威"><a class="markdownIt-Anchor" href="#阶段一环境与基础设施的下马威"></a> 💀 阶段一：环境与基础设施的&quot;下马威&quot;</h3>
<h4 id="坑点-1docker-安装包失踪"><a class="markdownIt-Anchor" href="#坑点-1docker-安装包失踪"></a> 坑点 1：Docker 安装包&quot;失踪&quot;</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@supercore-hk:~# <span class="built_in">sudo</span> apt install docker-compose-plugin -y</span><br><span class="line">E: Unable to locate package docker-compose-plugin</span><br><span class="line">Failed to start docker.service: Unit docker.service not found.</span><br></pre></td></tr></table></figure>
<p><strong>最终解决方案：使用国内镜像</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> sh get-docker.sh --mirror Aliyun</span><br></pre></td></tr></table></figure>
<p><strong>经验教训</strong>：</p>
<ol>
<li><strong>不要盲目相信系统源</strong>：对于 Docker 这类快速发展的工具，官方源总是领先于系统源</li>
<li><strong>国内服务器必须考虑网络因素</strong>：直接访问国外资源往往不稳定</li>
</ol>
<h4 id="坑点-2服务器磁盘空间幽灵"><a class="markdownIt-Anchor" href="#坑点-2服务器磁盘空间幽灵"></a> 坑点 2：服务器磁盘空间&quot;幽灵&quot;</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm warn tar TAR_ENTRY_ERROR ENOSPC: no space left on device, write</span><br></pre></td></tr></table></figure>
<p><strong>解决过程</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">growpart /dev/vda 1</span><br><span class="line">resize2fs /dev/vda1</span><br></pre></td></tr></table></figure>
<p><strong>经验教训</strong>：</p>
<ol>
<li><strong>云盘扩容需要两步操作</strong>：分区扩展 + 文件系统扩展</li>
<li><strong>df -h 看到的不一定是真实大小</strong>：需要用 fdisk 确认磁盘实际大小</li>
</ol>
<h3 id="阶段二supabase-数据库的密码地狱-最艰难的战役"><a class="markdownIt-Anchor" href="#阶段二supabase-数据库的密码地狱-最艰难的战役"></a> 💀 阶段二：Supabase 数据库的&quot;密码地狱&quot; (最艰难的战役)</h3>
<h4 id="坑点-3特殊字符引发的连接串解析失败"><a class="markdownIt-Anchor" href="#坑点-3特殊字符引发的连接串解析失败"></a> 坑点 3：特殊字符引发的连接串解析失败</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">could not translate host name <span class="string">&quot;2022bOER@2022@db&quot;</span> to address: Name or service not known</span><br></pre></td></tr></table></figure>
<p><strong>最终解决方案</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POSTGRES_PASSWORD=Super2022admin</span><br><span class="line"><span class="comment"># 移除所有特殊字符</span></span><br></pre></td></tr></table></figure>
<h4 id="坑点-4docker-卷持久化导致的密码分裂"><a class="markdownIt-Anchor" href="#坑点-4docker-卷持久化导致的密码分裂"></a> 坑点 4：Docker 卷持久化导致的&quot;密码分裂&quot;</h4>
<p><strong>问题分析</strong>：<br />
Docker 的卷持久化机制保存了旧的数据库配置，即使修改了 <code>.env</code> 文件，已经存在的数据库数据仍然使用旧密码。</p>
<p><strong>最终解决方案：数据库&quot;上帝模式&quot;重置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 修改 pg_hba.conf 为 trust 模式</span></span><br><span class="line">docker <span class="built_in">exec</span> supabase-db bash -c <span class="string">&quot;echo &#x27;local all all trust&#x27; &gt; /var/lib/postgresql/data/pg_hba.conf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 无密码连接并重置所有系统账号</span></span><br><span class="line">docker <span class="built_in">exec</span> -it supabase-db psql -U postgres &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">ALTER USER postgres PASSWORD &#x27;YourSecurePassword&#x27;;</span></span><br><span class="line"><span class="string">ALTER USER supabase_auth_admin PASSWORD &#x27;YourSecurePassword&#x27;;</span></span><br><span class="line"><span class="string">ALTER USER supabase_storage_admin PASSWORD &#x27;YourSecurePassword&#x27;;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>
<h3 id="阶段三nuxt-构建与运行时的崩溃循环"><a class="markdownIt-Anchor" href="#阶段三nuxt-构建与运行时的崩溃循环"></a> 💀 阶段三：Nuxt 构建与运行时的&quot;崩溃循环&quot;</h3>
<h4 id="坑点-5构建时内存溢出-oom"><a class="markdownIt-Anchor" href="#坑点-5构建时内存溢出-oom"></a> 坑点 5：构建时内存溢出 (OOM)</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br><span class="line"><span class="comment"># 服务器卡死，SSH 连接断开</span></span><br><span class="line"></span><br><span class="line">dmesg | <span class="built_in">tail</span> -10</span><br><span class="line"><span class="comment"># [12345.678] Out of memory: Kill process 1234 (npm) score 900</span></span><br></pre></td></tr></table></figure>
<p><strong>解决过程</strong>：</p>
<p><strong>步骤一：配置 Swap 虚拟内存</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fallocate -l 4G /swapfile</span><br><span class="line"><span class="built_in">chmod</span> 600 /swapfile</span><br><span class="line">mkswap /swapfile</span><br><span class="line">swapon /swapfile</span><br></pre></td></tr></table></figure>
<p><strong>步骤二：优化 Nuxt 配置</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineNuxtConfig</span>(&#123;</span><br><span class="line">  <span class="attr">sourcemap</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">nitro</span>: &#123;</span><br><span class="line">    <span class="attr">prerender</span>: &#123;</span><br><span class="line">      <span class="attr">concurrency</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="坑点-6ssr-环境下的-pinia-崩溃"><a class="markdownIt-Anchor" href="#坑点-6ssr-环境下的-pinia-崩溃"></a> 坑点 6：SSR 环境下的 Pinia 崩溃</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: Cannot <span class="built_in">read</span> properties of undefined (reading <span class="string">&#x27;state&#x27;</span>) (500 Error)</span><br></pre></td></tr></table></figure>
<p><strong>最终解决方案</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将通用插件改为客户端专用</span></span><br><span class="line"><span class="built_in">mv</span> plugins/pinia-persist.ts plugins/pinia-persist.client.ts</span><br></pre></td></tr></table></figure>
<h3 id="阶段四连通性与配置的最后一步"><a class="markdownIt-Anchor" href="#阶段四连通性与配置的最后一步"></a> 💀 阶段四：连通性与配置的&quot;最后一步&quot;</h3>
<h4 id="坑点-7无效的-api-key-invalid-signature"><a class="markdownIt-Anchor" href="#坑点-7无效的-api-key-invalid-signature"></a> 坑点 7：无效的 API Key (Invalid Signature)</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;code&quot;</span>:401,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Invalid signature&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<p><strong>解决过程</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 固定 JWT_SECRET</span></span><br><span class="line">JWT_SECRET=Jk8s9D2f7G4hP1qR6tW3zY5uV8iA0mN1xL4cB5eF7gH2jK9lP3oQ6rS8tU1vW</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 使用 SQL 重新生成 API Keys</span></span><br><span class="line">SELECT auth.jwt(<span class="string">&#x27;&#123;&quot;role&quot;:&quot;anon&quot;,&quot;iss&quot;:&quot;supabase&quot;&#125;&#x27;</span>::json) as anon_key;</span><br></pre></td></tr></table></figure>
<h4 id="坑点-8certbot-python-环境冲突"><a class="markdownIt-Anchor" href="#坑点-8certbot-python-环境冲突"></a> 坑点 8：Certbot Python 环境冲突</h4>
<p><strong>报错现场</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImportError: cannot import name <span class="string">&#x27;appengine&#x27;</span> from <span class="string">&#x27;google.auth.transport&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>解决方案</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install <span class="string">&#x27;urllib3==1.26.16&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="结语"><a class="markdownIt-Anchor" href="#结语"></a> 结语</h2>
<h3 id="核心经验总结"><a class="markdownIt-Anchor" href="#核心经验总结"></a> 核心经验总结</h3>
<p>经过这次完整的私有化部署实践，我们深刻体会到：<strong>全栈独立开发不仅仅是写代码，更是对 Linux、Docker、网络协议和构建工具链的综合考验</strong>。</p>
<h3 id="最关键的经验教训"><a class="markdownIt-Anchor" href="#最关键的经验教训"></a> 最关键的经验教训</h3>
<h4 id="1-永远掌控你的配置"><a class="markdownIt-Anchor" href="#1-永远掌控你的配置"></a> 1. 永远掌控你的配置</h4>
<p><strong>不要相信&quot;自动生成的配置&quot;</strong>：</p>
<ul>
<li><code>JWT_SECRET</code> 必须手动生成并固定，自动生成会导致所有 API Key 失效</li>
<li>数据库密码避免特殊字符，PostgreSQL 连接串解析很脆弱</li>
</ul>
<h4 id="2-资源限制下的优化策略"><a class="markdownIt-Anchor" href="#2-资源限制下的优化策略"></a> 2. 资源限制下的优化策略</h4>
<p><strong>小内存服务器必须做针对性优化</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Swap 虚拟内存是必备的</span></span><br><span class="line">fallocate -l 4G /swapfile &amp;&amp; <span class="built_in">chmod</span> 600 /swapfile &amp;&amp; mkswap /swapfile &amp;&amp; swapon /swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 构建优化配置</span></span><br><span class="line"><span class="built_in">export</span> NODE_OPTIONS=<span class="string">&quot;--max-old-space-size=1536&quot;</span></span><br><span class="line">npm run build -- --no-sourcemap</span><br></pre></td></tr></table></figure>
<h3 id="给后来者的建议"><a class="markdownIt-Anchor" href="#给后来者的建议"></a> 给后来者的建议</h3>
<h4 id="部署前准备"><a class="markdownIt-Anchor" href="#部署前准备"></a> 部署前准备</h4>
<ol>
<li><strong>充分测试</strong>：在类似环境先完整测试一遍部署流程</li>
<li><strong>备份策略</strong>：确保有完整的备份和恢复方案</li>
<li><strong>监控准备</strong>：提前配置好日志收集和监控告警</li>
</ol>
<h4 id="部署过程中"><a class="markdownIt-Anchor" href="#部署过程中"></a> 部署过程中</h4>
<ol>
<li><strong>分步验证</strong>：每完成一个阶段就验证功能正常</li>
<li><strong>日志监控</strong>：实时监控各服务的日志，及时发现问题</li>
<li><strong>回滚准备</strong>：准备好快速回滚方案，减少故障时间</li>
</ol>
<h3 id="最终的价值"><a class="markdownIt-Anchor" href="#最终的价值"></a> 最终的价值</h3>
<p>虽然私有化部署过程充满挑战，但带来的价值是显著的：</p>
<ol>
<li><strong>数据掌控</strong>：所有数据都在自己的服务器中，满足合规要求</li>
<li><strong>成本可控</strong>：避免了 SaaS 服务的指数级费用增长</li>
<li><strong>性能优化</strong>：可以根据业务需求进行针对性优化</li>
<li><strong>技术成长</strong>：全栈部署经验是工程师的重要技能</li>
</ol>
<hr />
<p><strong>相关资源</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://supabase.com/docs">Supabase 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://nuxt.com/docs/getting-started/deployment">Nuxt 3 部署指南</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/compose/">Docker Compose 最佳实践</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/resources/wiki/start/">Nginx 配置优化</a></li>
</ul>
<p>如有问题或建议，欢迎提交 Issue 或 Pull Request！</p>
<hr />
<blockquote>
<p>本文由 opencode + glm4.7 基于真实部署对话整理，记录了从踩坑到成功的完整私有化部署历程。</p>
</blockquote>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/tianxingleo.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/tianxingleo.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Tianxingleo</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/')">Nuxt3+Supabase全栈应用私有化部署全记录</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Nuxt3+Supabase全栈应用私有化部署全记录&amp;url=http://tianxingleo.top/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/&amp;pic=https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.jpg?_r_=1181c49c-f5a9-72b5-5e04-c0abe2b5f579" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://tianxingleo.top" target="_blank">Tianxingleo的Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/vps/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>vps<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/nuxt/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>nuxt<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/supabase/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>supabase<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/9c7026124dcb360f454545904aac9838cb95adb8.webp?_r_=0292cd08-439d-6a58-6766-93ad0dd1bedc" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2026/02/02/GAMES101-Lecture-01-Overview-of-Computer-Graphics-%E7%AC%94%E8%AE%B0/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/94219701_p0.webp?_r_=f9531c55-b7f9-9576-aa8d-faf61fa92d53" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">GAMES101笔记： Lecture 01 Overview of Computer Graphics &amp; Lecture 02 Review of Linear Algebra &amp; Lecture 03 Transformation &amp; Lecture 04 Transformation Cont.</div></div></a></div><div class="next-post pull-right"><a href="/2026/02/10/%E5%9F%8E%E5%B8%82%E7%BA%A7%E5%A4%9A%E6%A8%A1%E6%80%81%E6%B7%B7%E5%90%88%E7%A5%9E%E7%BB%8F%E9%87%8D%E5%BB%BA%EF%BC%9A%E5%9F%BA%E4%BA%8EGIS%E5%87%A0%E4%BD%95%E5%85%88%E9%AA%8C%E4%B8%8E%E8%AF%AD%E4%B9%89-%E5%87%A0%E4%BD%95%E5%9C%BA%E5%88%86%E8%A7%A3%E7%9A%84%E7%9C%9F%E5%AE%9E%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E8%B0%83%E7%A0%94%E6%8A%A5%E5%91%8A/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/9c7026124dcb360f454545904aac9838cb95adb8.webp?_r_=0292cd08-439d-6a58-6766-93ad0dd1bedc" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">：基于GIS几何先验与语义-几何场分解的真实三维重建调研报告</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2026/01/15/VSCode%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%EF%BC%9A%E4%BD%BF%E7%94%A8FRP%E8%87%AA%E5%BB%BA%E5%85%AC%E7%BD%91%E7%A9%BF%E9%80%8F%E4%B8%8E%E5%86%85%E7%BD%91%E7%9B%B4%E8%BF%9E%E6%96%B9%E6%A1%88/" title="VSCode远程开发指南：使用FRP自建公网穿透与内网直连方案"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.webp?_r_=7cebf587-6870-0f1d-fc09-fed9ea6a21f6" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2026-01-15</div><div class="title">VSCode远程开发指南：使用FRP自建公网穿透与内网直连方案</div></div></a></div><div><a href="/2026/01/15/%E9%92%88%E5%AF%B9-RackNerd-VPS-%E4%B8%8E%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8%E5%87%BA%E5%8F%A3%E5%B8%A6%E5%AE%BD%E9%99%90%E5%88%B6%E7%9A%84%E6%8E%92%E6%9F%A5%E4%B8%8E%E4%BC%98%E5%8C%96%E6%8C%87%E5%8D%97/" title="针对 RackNerd VPS 与中国移动出口带宽限制的排查与优化指南"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/94219701_p0.webp?_r_=e293b304-77bf-313f-6737-b39e8ed120bf" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2026-01-15</div><div class="title">针对 RackNerd VPS 与中国移动出口带宽限制的排查与优化指南</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.com/tianxingleo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);"><b style="color:#fff">这是天马行空（tianxingleo）</b>的blog，用于<b style="color:#fff">记录、分享、学习、交流</b></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Tianxingleo</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#nuxt3-supabase-%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text"> Nuxt3 + Supabase 全栈应用私有化部署全记录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text"> 文章结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%90%86%E6%83%B3%E4%B9%8B%E8%B7%AF-%E6%A0%87%E5%87%86%E5%8C%96%E9%83%A8%E7%BD%B2-sop-%E5%A6%82%E6%9E%9C%E4%B8%8D%E8%B8%A9%E5%9D%91%E4%BD%A0%E5%BA%94%E8%AF%A5%E8%BF%99%E6%A0%B7%E5%81%9A"><span class="toc-number">1.2.</span> <span class="toc-text"> 第一部分：理想之路 —— 标准化部署 SOP (如果不踩坑，你应该这样做)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E4%B8%8E%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-infrastructure"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 一、 基础设施与环境准备 (Infrastructure)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%89%E5%9E%8B%E4%B8%8E%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.2.1.1.</span> <span class="toc-text"> 1.1 服务器选型与初始化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E5%9F%BA%E5%87%86%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.1.1.</span> <span class="toc-text"> 硬件基准配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%BB%84%E9%85%8D%E7%BD%AE-firewall"><span class="toc-number">1.2.1.1.2.</span> <span class="toc-text"> 安全组配置 (Firewall)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.1.1.3.</span> <span class="toc-text"> 磁盘空间管理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#swap-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.1.4.</span> <span class="toc-text"> Swap 虚拟内存配置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E6%A0%B8%E5%BF%83%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.1.2.</span> <span class="toc-text"> 1.2 核心软件安装</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#git-%E5%AE%89%E8%A3%85%E4%B8%8E-ssh-key-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.2.1.</span> <span class="toc-text"> Git 安装与 SSH Key 配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#docker-docker-compose-v2-%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.1.2.2.</span> <span class="toc-text"> Docker &amp; Docker Compose v2 安装</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-supabase-%E5%90%8E%E7%AB%AF%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2-backend"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 二、 Supabase 后端私有化部署 (Backend)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#21-%E5%AE%98%E6%96%B9-docker-%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> 2.1 官方 Docker 仓库配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-supabase-docker-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.1.1.</span> <span class="toc-text"> 获取 Supabase Docker 配置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-env-%E9%BB%84%E9%87%91%E6%B3%95%E5%88%99"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> 2.2 环境变量 (.env) 黄金法则</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%A0%B8%E5%BF%83jwt_secret-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.2.1.</span> <span class="toc-text"> 安全核心：JWT_SECRET 配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%99%B7%E9%98%B1%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E9%99%90%E5%88%B6"><span class="toc-number">1.2.2.2.2.</span> <span class="toc-text"> 密码陷阱：特殊符号限制</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#23-%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E4%B8%8E%E9%AA%8C%E8%AF%81"><span class="toc-number">1.2.2.3.</span> <span class="toc-text"> 2.3 服务启动与验证</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8-supabase-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.2.3.1.</span> <span class="toc-text"> 启动 Supabase 服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E7%AD%96%E7%95%A5-migration-strategy"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 三、 数据迁移策略 (Migration Strategy)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#31-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84%E8%BF%81%E7%A7%BB-schema"><span class="toc-number">1.2.3.1.</span> <span class="toc-text"> 3.1 数据库结构迁移 (Schema)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA-schema-only-%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.3.1.1.</span> <span class="toc-text"> 导出 Schema-only 结构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B-nuxt-3-%E5%89%8D%E7%AB%AF%E5%AE%B9%E5%99%A8%E5%8C%96%E9%80%82%E9%85%8D-frontend-adaptation"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 四、 Nuxt 3 前端容器化适配 (Frontend Adaptation)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#41-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B7%B1%E5%BA%A6%E8%B0%83%E4%BC%98-nuxtconfigts"><span class="toc-number">1.2.4.1.</span> <span class="toc-text"> 4.1 配置文件深度调优 (nuxt.config.ts)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.4.1.1.</span> <span class="toc-text"> 内存优化配置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#42-dockerfile-%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.4.2.</span> <span class="toc-text"> 4.2 Dockerfile 编写规范</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E7%9A%84-dockerfile-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.4.2.1.</span> <span class="toc-text"> 完整的 Dockerfile 示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2-cicd-with-github-actions"><span class="toc-number">1.2.5.</span> <span class="toc-text"> 五、 自动化部署 (CI&#x2F;CD with GitHub Actions)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#51-%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.5.1.</span> <span class="toc-text"> 5.1 密钥管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#github-secrets-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.5.1.1.</span> <span class="toc-text"> GitHub Secrets 配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD-%E7%BD%91%E5%85%B3%E4%B8%8E%E5%AE%89%E5%85%A8-nginx-ssl"><span class="toc-number">1.2.6.</span> <span class="toc-text"> 六、 网关与安全 (Nginx &amp; SSL)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#61-nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.6.1.</span> <span class="toc-text"> 6.1 Nginx 反向代理配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E5%9F%9F%E5%90%8D%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.6.1.1.</span> <span class="toc-text"> 多域名策略配置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#62-ssl-%E8%AF%81%E4%B9%A6%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">1.2.6.2.</span> <span class="toc-text"> 6.2 SSL 证书自动化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%B3%E8%AF%B7-ssl-%E8%AF%81%E4%B9%A6"><span class="toc-number">1.2.6.2.1.</span> <span class="toc-text"> 申请 SSL 证书</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E5%AE%9E%E6%88%98%E8%B8%A9%E5%9D%91%E5%AE%9E%E5%BD%95-%E6%AF%8F%E4%B8%80%E4%B8%AA%E6%8A%A5%E9%94%99%E8%83%8C%E5%90%8E%E7%9A%84%E8%A1%80%E6%B3%AA-the-debugging-logs"><span class="toc-number">1.3.</span> <span class="toc-text"> 第二部分：实战踩坑实录 —— 每一个报错背后的血泪 (The Debugging Logs)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%B8%80%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E7%9A%84%E4%B8%8B%E9%A9%AC%E5%A8%81"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 💀 阶段一：环境与基础设施的&quot;下马威&quot;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-1docker-%E5%AE%89%E8%A3%85%E5%8C%85%E5%A4%B1%E8%B8%AA"><span class="toc-number">1.3.1.1.</span> <span class="toc-text"> 坑点 1：Docker 安装包&quot;失踪&quot;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E5%B9%BD%E7%81%B5"><span class="toc-number">1.3.1.2.</span> <span class="toc-text"> 坑点 2：服务器磁盘空间&quot;幽灵&quot;</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%BA%8Csupabase-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AF%86%E7%A0%81%E5%9C%B0%E7%8B%B1-%E6%9C%80%E8%89%B0%E9%9A%BE%E7%9A%84%E6%88%98%E5%BD%B9"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 💀 阶段二：Supabase 数据库的&quot;密码地狱&quot; (最艰难的战役)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-3%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E5%BC%95%E5%8F%91%E7%9A%84%E8%BF%9E%E6%8E%A5%E4%B8%B2%E8%A7%A3%E6%9E%90%E5%A4%B1%E8%B4%A5"><span class="toc-number">1.3.2.1.</span> <span class="toc-text"> 坑点 3：特殊字符引发的连接串解析失败</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-4docker-%E5%8D%B7%E6%8C%81%E4%B9%85%E5%8C%96%E5%AF%BC%E8%87%B4%E7%9A%84%E5%AF%86%E7%A0%81%E5%88%86%E8%A3%82"><span class="toc-number">1.3.2.2.</span> <span class="toc-text"> 坑点 4：Docker 卷持久化导致的&quot;密码分裂&quot;</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%B8%89nuxt-%E6%9E%84%E5%BB%BA%E4%B8%8E%E8%BF%90%E8%A1%8C%E6%97%B6%E7%9A%84%E5%B4%A9%E6%BA%83%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 💀 阶段三：Nuxt 构建与运行时的&quot;崩溃循环&quot;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-5%E6%9E%84%E5%BB%BA%E6%97%B6%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA-oom"><span class="toc-number">1.3.3.1.</span> <span class="toc-text"> 坑点 5：构建时内存溢出 (OOM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-6ssr-%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84-pinia-%E5%B4%A9%E6%BA%83"><span class="toc-number">1.3.3.2.</span> <span class="toc-text"> 坑点 6：SSR 环境下的 Pinia 崩溃</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E5%9B%9B%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5"><span class="toc-number">1.3.4.</span> <span class="toc-text"> 💀 阶段四：连通性与配置的&quot;最后一步&quot;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-7%E6%97%A0%E6%95%88%E7%9A%84-api-key-invalid-signature"><span class="toc-number">1.3.4.1.</span> <span class="toc-text"> 坑点 7：无效的 API Key (Invalid Signature)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%91%E7%82%B9-8certbot-python-%E7%8E%AF%E5%A2%83%E5%86%B2%E7%AA%81"><span class="toc-number">1.3.4.2.</span> <span class="toc-text"> 坑点 8：Certbot Python 环境冲突</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">1.4.</span> <span class="toc-text"> 结语</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 核心经验总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%85%B3%E9%94%AE%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%95%99%E8%AE%AD"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 最关键的经验教训</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B0%B8%E8%BF%9C%E6%8E%8C%E6%8E%A7%E4%BD%A0%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.2.1.</span> <span class="toc-text"> 1. 永远掌控你的配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6%E4%B8%8B%E7%9A%84%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">1.4.2.2.</span> <span class="toc-text"> 2. 资源限制下的优化策略</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E5%90%8E%E6%9D%A5%E8%80%85%E7%9A%84%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.4.3.</span> <span class="toc-text"> 给后来者的建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E5%89%8D%E5%87%86%E5%A4%87"><span class="toc-number">1.4.3.1.</span> <span class="toc-text"> 部署前准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E8%BF%87%E7%A8%8B%E4%B8%AD"><span class="toc-number">1.4.3.2.</span> <span class="toc-text"> 部署过程中</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E7%9A%84%E4%BB%B7%E5%80%BC"><span class="toc-number">1.4.4.</span> <span class="toc-text"> 最终的价值</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/10/%E5%9F%8E%E5%B8%82%E7%BA%A7%E5%A4%9A%E6%A8%A1%E6%80%81%E6%B7%B7%E5%90%88%E7%A5%9E%E7%BB%8F%E9%87%8D%E5%BB%BA%EF%BC%9A%E5%9F%BA%E4%BA%8EGIS%E5%87%A0%E4%BD%95%E5%85%88%E9%AA%8C%E4%B8%8E%E8%AF%AD%E4%B9%89-%E5%87%A0%E4%BD%95%E5%9C%BA%E5%88%86%E8%A7%A3%E7%9A%84%E7%9C%9F%E5%AE%9E%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E8%B0%83%E7%A0%94%E6%8A%A5%E5%91%8A/" title="：基于GIS几何先验与语义-几何场分解的真实三维重建调研报告"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/9c7026124dcb360f454545904aac9838cb95adb8.webp?_r_=0292cd08-439d-6a58-6766-93ad0dd1bedc" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="：基于GIS几何先验与语义-几何场分解的真实三维重建调研报告"/></a><div class="content"><a class="title" href="/2026/02/10/%E5%9F%8E%E5%B8%82%E7%BA%A7%E5%A4%9A%E6%A8%A1%E6%80%81%E6%B7%B7%E5%90%88%E7%A5%9E%E7%BB%8F%E9%87%8D%E5%BB%BA%EF%BC%9A%E5%9F%BA%E4%BA%8EGIS%E5%87%A0%E4%BD%95%E5%85%88%E9%AA%8C%E4%B8%8E%E8%AF%AD%E4%B9%89-%E5%87%A0%E4%BD%95%E5%9C%BA%E5%88%86%E8%A7%A3%E7%9A%84%E7%9C%9F%E5%AE%9E%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E8%B0%83%E7%A0%94%E6%8A%A5%E5%91%8A/" title="：基于GIS几何先验与语义-几何场分解的真实三维重建调研报告">：基于GIS几何先验与语义-几何场分解的真实三维重建调研报告</a><time datetime="2026-02-10T09:32:07.000Z" title="发表于 2026-02-10 17:32:07">2026-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/" title="Nuxt3+Supabase全栈应用私有化部署全记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/114477837_p0_master1200.jpg?_r_=1181c49c-f5a9-72b5-5e04-c0abe2b5f579" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nuxt3+Supabase全栈应用私有化部署全记录"/></a><div class="content"><a class="title" href="/2026/02/10/Nuxt3-Supabase%E5%85%A8%E6%A0%88%E5%BA%94%E7%94%A8%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2%E5%85%A8%E8%AE%B0%E5%BD%95/" title="Nuxt3+Supabase全栈应用私有化部署全记录">Nuxt3+Supabase全栈应用私有化部署全记录</a><time datetime="2026-02-10T08:01:34.000Z" title="发表于 2026-02-10 16:01:34">2026-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/02/GAMES101-Lecture-01-Overview-of-Computer-Graphics-%E7%AC%94%E8%AE%B0/" title="GAMES101笔记： Lecture 01 Overview of Computer Graphics &amp; Lecture 02 Review of Linear Algebra &amp; Lecture 03 Transformation &amp; Lecture 04 Transformation Cont."><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/94219701_p0.webp?_r_=f9531c55-b7f9-9576-aa8d-faf61fa92d53" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101笔记： Lecture 01 Overview of Computer Graphics &amp; Lecture 02 Review of Linear Algebra &amp; Lecture 03 Transformation &amp; Lecture 04 Transformation Cont."/></a><div class="content"><a class="title" href="/2026/02/02/GAMES101-Lecture-01-Overview-of-Computer-Graphics-%E7%AC%94%E8%AE%B0/" title="GAMES101笔记： Lecture 01 Overview of Computer Graphics &amp; Lecture 02 Review of Linear Algebra &amp; Lecture 03 Transformation &amp; Lecture 04 Transformation Cont.">GAMES101笔记： Lecture 01 Overview of Computer Graphics &amp; Lecture 02 Review of Linear Algebra &amp; Lecture 03 Transformation &amp; Lecture 04 Transformation Cont.</a><time datetime="2026-02-02T11:11:55.000Z" title="发表于 2026-02-02 19:11:55">2026-02-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/01/NAOSI%E7%95%99%E5%AD%A6%E8%AE%B2%E5%BA%A7%E7%AC%94%E8%AE%B0/" title="NAOSI留学讲座笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/94219701_p0.webp?_r_=5b69de1a-39a2-7271-2c70-6f5996b5b7ee" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NAOSI留学讲座笔记"/></a><div class="content"><a class="title" href="/2026/02/01/NAOSI%E7%95%99%E5%AD%A6%E8%AE%B2%E5%BA%A7%E7%AC%94%E8%AE%B0/" title="NAOSI留学讲座笔记">NAOSI留学讲座笔记</a><time datetime="2026-02-01T11:59:49.000Z" title="发表于 2026-02-01 19:59:49">2026-02-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/30/CPU%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B7%91LLM%E5%AE%9E%E5%BD%95/" title="CPU服务器跑LLM实录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pub-f8d3afa0c3274f1e943ee2f8c45dff96.r2.dev/7ae2047cde0451cf21fa7a8842565b58f0e9d1e1.webp?_r_=1e235ee7-67be-ad8e-5cc3-53ba5d7c2f28" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CPU服务器跑LLM实录"/></a><div class="content"><a class="title" href="/2026/01/30/CPU%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B7%91LLM%E5%AE%9E%E5%BD%95/" title="CPU服务器跑LLM实录">CPU服务器跑LLM实录</a><time datetime="2026-01-30T14:35:08.000Z" title="发表于 2026-01-30 22:35:08">2026-01-30</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 - 2026 By <a class="footer-bar-link" href="/" title="Tianxingleo" target="_blank">Tianxingleo</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">55</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">84</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://tianxingleo.github.io" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://avatars.githubusercontent.com/u/237200863?v=4" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/tianxingleo" title="Github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://github.githubassets.com/assets/GitHub-Mark-ea2971cee799.png" alt="Github"/><span class="back-menu-item-text">Github</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/3dgs/" style="font-size: 0.88rem;">3dgs<sup>7</sup></a><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/CG/" style="font-size: 0.88rem;">CG<sup>6</sup></a><a href="/tags/CV/" style="font-size: 0.88rem;">CV<sup>5</sup></a><a href="/tags/GAMES/" style="font-size: 0.88rem;">GAMES<sup>1</sup></a><a href="/tags/GAMES101/" style="font-size: 0.88rem;">GAMES101<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 0.88rem;">LLM<sup>1</sup></a><a href="/tags/NAOSI/" style="font-size: 0.88rem;">NAOSI<sup>1</sup></a><a href="/tags/SDFoam/" style="font-size: 0.88rem;">SDFoam<sup>4</sup></a><a href="/tags/c/" style="font-size: 0.88rem;">c<sup>4</sup></a><a href="/tags/cpc/" style="font-size: 0.88rem;">cpc<sup>4</sup></a><a href="/tags/cpp/" style="font-size: 0.88rem;">cpp<sup>14</sup></a><a href="/tags/css/" style="font-size: 0.88rem;">css<sup>1</sup></a><a href="/tags/frp/" style="font-size: 0.88rem;">frp<sup>1</sup></a><a href="/tags/html/" style="font-size: 0.88rem;">html<sup>1</sup></a><a href="/tags/mask/" style="font-size: 0.88rem;">mask<sup>1</sup></a><a href="/tags/nerfstudio/" style="font-size: 0.88rem;">nerfstudio<sup>1</sup></a><a href="/tags/nuxt/" style="font-size: 0.88rem;">nuxt<sup>1</sup></a><a href="/tags/sam/" style="font-size: 0.88rem;">sam<sup>1</sup></a><a href="/tags/sam3/" style="font-size: 0.88rem;">sam3<sup>1</sup></a><a href="/tags/ssh/" style="font-size: 0.88rem;">ssh<sup>1</sup></a><a href="/tags/supabase/" style="font-size: 0.88rem;">supabase<sup>1</sup></a><a href="/tags/tic/" style="font-size: 0.88rem;">tic<sup>1</sup></a><a href="/tags/vps/" style="font-size: 0.88rem;">vps<sup>3</sup></a><a href="/tags/vscode/" style="font-size: 0.88rem;">vscode<sup>2</sup></a><a href="/tags/yolo/" style="font-size: 0.88rem;">yolo<sup>1</sup></a><a href="/tags/%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA/" style="font-size: 0.88rem;">三维重建<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 0.88rem;">函数<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>1</sup></a><a href="/tags/%E5%A4%A7%E5%AD%A6/" style="font-size: 0.88rem;">大学<sup>11</sup></a><a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 0.88rem;">字符串<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">学习<sup>6</sup></a><a href="/tags/%E6%8C%87%E9%92%88/" style="font-size: 0.88rem;">指针<sup>2</sup></a><a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 0.88rem;">搜索<sup>1</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 0.88rem;">服务器<sup>1</sup></a><a href="/tags/%E7%95%99%E5%AD%A6/" style="font-size: 0.88rem;">留学<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 0.88rem;">算法<sup>6</sup></a><a href="/tags/%E7%BB%93%E6%9E%84%E4%BD%93/" style="font-size: 0.88rem;">结构体<sup>1</sup></a><a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 0.88rem;">链表<sup>1</sup></a><a href="/tags/%E9%AB%98%E6%95%B0/" style="font-size: 0.88rem;">高数<sup>7</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("14/10/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Tianxingleo 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: '',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-NVDE0BFR5M', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>